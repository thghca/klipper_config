[gcode_macro FILAMENT_UNLOAD]
variable_length: 80.0
gcode:
	{% if not printer.extruder.can_extrude %}
		_SOUND_NOTIFY
		RESPOND MSG="Prevented cold unload!"
	{% elif printer.idle_timeout.state == "Printing" %}
		_SOUND_NOTIFY
		RESPOND MSG="Unload cannot be used while printing!"
	{% else %}
		_SOUND_BEEP
		_GPUSH	
		M83											#relative e positioning 
		G0 E{params.E|default(-length)|int} F400	#unload
		_GPOP
		M400										#wait for complete
		_SOUND_BEEP
	{% endif %}


[gcode_macro FILAMENT_LOAD]
variable_length: 80.0
gcode:
	{% if not printer.extruder.can_extrude %}
		_SOUND_NOTIFY
		RESPOND MSG="Prevented cold load!"
	{% elif printer.idle_timeout.state == "Printing" %}
		_SOUND_NOTIFY
		RESPOND MSG="Load cannot be used while printing!"
	{% else %}
		_SOUND_BEEP
		_GPUSH
		M83											#relative e positioning 
		G0 E{params.E|default(length)|int} F400		#load
		_GPOP
		M400										#wait for complete
		_SOUND_BEEP
	{% endif %}
